<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="这篇文章主要介绍kaggle上的Kobe Bryant Shot Selection 这道题，是预测科比每次投篮的命中情况预测"><meta name="keywords" content="kaggle,Kobe,结题报告"><meta name="author" content="Victor Zhang,undefined"><meta name="copyright" content="Victor Zhang"><title>Kobe 投篮预测比赛解题报告 | Cupdish.com</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.1"><script>var GLOBAL = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  localSearch: undefined
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#题目数据分析"><span class="toc-number">1.</span> <span class="toc-text">题目数据分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#特征构造"><span class="toc-number">2.</span> <span class="toc-text">特征构造</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用模型"><span class="toc-number">3.</span> <span class="toc-text">使用模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#xgboost"><span class="toc-number">3.1.</span> <span class="toc-text">xgboost</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#neural-networks"><span class="toc-number">3.2.</span> <span class="toc-text">neural networks</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#组合模型"><span class="toc-number">4.</span> <span class="toc-text">组合模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#解题心得"><span class="toc-number">5.</span> <span class="toc-text">解题心得</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#学到的知识"><span class="toc-number">5.1.</span> <span class="toc-text">学到的知识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#不足"><span class="toc-number">5.2.</span> <span class="toc-text">不足</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Victor Zhang</div><div class="author-info__description text-center">欢迎</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">6</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">10</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">3</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container" style="background-image: url(true)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Cupdish.com</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a></span></div><div id="post-info"><div id="post-title">Kobe 投篮预测比赛解题报告</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2016-06-15</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/数据挖掘/">数据挖掘</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div id="post-content"><h2 id="题目数据分析"><a href="#题目数据分析" class="headerlink" title="题目数据分析"></a>题目数据分析</h2><p>这道<a href="https://www.kaggle.com/c/kobe-bryant-shot-selection" target="_blank" rel="noopener">Kaggle题目</a>还是蛮与时俱进的，科比刚刚退役，这道题目就上线了。这道题目主要是把科比在役这么多年以来的比赛投篮数据，主要是NBA的，拿过来，每一项数据就是一次投蓝，当然包括中或者不中，主要是预测科比这次投篮到底是中还是不中。中就是1，不中就是0。每个数据包含了科比的投篮方式，是在什么时间的什么比赛，是不是季后赛，以及投球时所剩余的时间等等信息。从这么多次投篮中，挖去了一些投球结果，比赛的目的就是让参赛选手通过分析没有挖去的训练数据中进行学习和挖掘，然后预测挖去的投球结果到底是中了还是没中。</p>
<p>所有的代码我已经放的我的<a href="https://github.com/ssdf93/kaggle" target="_blank" rel="noopener">Github</a>上面。</p>
<p>首先，根据<code>shot_made_flag</code>来分数据集和训练集，不为空的数据为训练集，为空的数据为测试集。</p>
<p>在本文中，我使用的编程语言是<code>Python3.4</code>,使用的包有<code>numpy</code>,<code>pandas</code>,<code>scikit-learn</code>以及<code>Keras</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_data</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> sample:</span><br><span class="line">        data = pd.read_csv(<span class="string">"./data/data_min.csv"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data = pd.read_csv(<span class="string">"./data/data.csv"</span>)</span><br><span class="line"></span><br><span class="line">    print(data[<span class="string">'shot_distance'</span>].max())</span><br><span class="line"></span><br><span class="line">    train=data[data[target].notnull()].reset_index(drop=<span class="keyword">True</span>)</span><br><span class="line">    test=data[data[target].isnull()].reset_index(drop=<span class="keyword">True</span>)</span><br><span class="line"></span><br><span class="line">    print(train.info())</span><br><span class="line">    print(test.info())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> data,train,test</span><br></pre></td></tr></table></figure>
<p>输出的结果如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">79</span></span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">pandas</span>.<span class="title">core</span>.<span class="title">frame</span>.<span class="title">DataFrame</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">RangeIndex</span>:</span> <span class="number">25697</span> entries, <span class="number">0</span> to <span class="number">25696</span></span><br><span class="line">Data columns (total <span class="number">25</span> columns):</span><br><span class="line">action_type           <span class="number">25697</span> non-null object</span><br><span class="line">combined_shot_type    <span class="number">25697</span> non-null object</span><br><span class="line">game_event_id         <span class="number">25697</span> non-null int64</span><br><span class="line">game_id               <span class="number">25697</span> non-null int64</span><br><span class="line">lat                   <span class="number">25697</span> non-null float64</span><br><span class="line">loc_x                 <span class="number">25697</span> non-null int64</span><br><span class="line">loc_y                 <span class="number">25697</span> non-null int64</span><br><span class="line">lon                   <span class="number">25697</span> non-null float64</span><br><span class="line">minutes_remaining     <span class="number">25697</span> non-null int64</span><br><span class="line">period                <span class="number">25697</span> non-null int64</span><br><span class="line">playoffs              <span class="number">25697</span> non-null int64</span><br><span class="line">season                <span class="number">25697</span> non-null object</span><br><span class="line">seconds_remaining     <span class="number">25697</span> non-null int64</span><br><span class="line">shot_distance         <span class="number">25697</span> non-null int64</span><br><span class="line">shot_made_flag        <span class="number">25697</span> non-null float64</span><br><span class="line">shot_type             <span class="number">25697</span> non-null object</span><br><span class="line">shot_zone_area        <span class="number">25697</span> non-null object</span><br><span class="line">shot_zone_basic       <span class="number">25697</span> non-null object</span><br><span class="line">shot_zone_range       <span class="number">25697</span> non-null object</span><br><span class="line">team_id               <span class="number">25697</span> non-null int64</span><br><span class="line">team_name             <span class="number">25697</span> non-null object</span><br><span class="line">game_date             <span class="number">25697</span> non-null object</span><br><span class="line">matchup               <span class="number">25697</span> non-null object</span><br><span class="line">opponent              <span class="number">25697</span> non-null object</span><br><span class="line">shot_id               <span class="number">25697</span> non-null int64</span><br><span class="line">dtypes: float64(<span class="number">3</span>), int64(<span class="number">11</span>), object(<span class="number">11</span>)</span><br><span class="line">memory usage: <span class="number">4.9</span>+ MB</span><br><span class="line"><span class="keyword">None</span></span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">pandas</span>.<span class="title">core</span>.<span class="title">frame</span>.<span class="title">DataFrame</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">RangeIndex</span>:</span> <span class="number">5000</span> entries, <span class="number">0</span> to <span class="number">4999</span></span><br><span class="line">Data columns (total <span class="number">25</span> columns):</span><br><span class="line">action_type           <span class="number">5000</span> non-null object</span><br><span class="line">combined_shot_type    <span class="number">5000</span> non-null object</span><br><span class="line">game_event_id         <span class="number">5000</span> non-null int64</span><br><span class="line">game_id               <span class="number">5000</span> non-null int64</span><br><span class="line">lat                   <span class="number">5000</span> non-null float64</span><br><span class="line">loc_x                 <span class="number">5000</span> non-null int64</span><br><span class="line">loc_y                 <span class="number">5000</span> non-null int64</span><br><span class="line">lon                   <span class="number">5000</span> non-null float64</span><br><span class="line">minutes_remaining     <span class="number">5000</span> non-null int64</span><br><span class="line">period                <span class="number">5000</span> non-null int64</span><br><span class="line">playoffs              <span class="number">5000</span> non-null int64</span><br><span class="line">season                <span class="number">5000</span> non-null object</span><br><span class="line">seconds_remaining     <span class="number">5000</span> non-null int64</span><br><span class="line">shot_distance         <span class="number">5000</span> non-null int64</span><br><span class="line">shot_made_flag        <span class="number">0</span> non-null float64</span><br><span class="line">shot_type             <span class="number">5000</span> non-null object</span><br><span class="line">shot_zone_area        <span class="number">5000</span> non-null object</span><br><span class="line">shot_zone_basic       <span class="number">5000</span> non-null object</span><br><span class="line">shot_zone_range       <span class="number">5000</span> non-null object</span><br><span class="line">team_id               <span class="number">5000</span> non-null int64</span><br><span class="line">team_name             <span class="number">5000</span> non-null object</span><br><span class="line">game_date             <span class="number">5000</span> non-null object</span><br><span class="line">matchup               <span class="number">5000</span> non-null object</span><br><span class="line">opponent              <span class="number">5000</span> non-null object</span><br><span class="line">shot_id               <span class="number">5000</span> non-null int64</span><br><span class="line">dtypes: float64(<span class="number">3</span>), int64(<span class="number">11</span>), object(<span class="number">11</span>)</span><br><span class="line">memory usage: <span class="number">976.6</span>+ KB</span><br><span class="line"><span class="keyword">None</span></span><br></pre></td></tr></table></figure>
<p>从上表可以看出，数据比较完整，不需要做过多的清洗和整理，因此，我没有去做过多的数据预处理。</p>
<p>最后的数据提交的是判断科比投篮投中的概率，0~1之间的一个数值，使用了<code>logLoss</code>的进行评估。<em>所以，提交的时候尽量交概率值，而不是分类值</em></p>
<h2 id="特征构造"><a href="#特征构造" class="headerlink" title="特征构造"></a>特征构造</h2><p>接下来就是数据的特征抽取和构造，这里，主要是对数据的提取和凝练，有些数据还是需要进行一些处理，比如将类别数据转换成哑变量，将数据归一化等等。</p>
<p>首先是对特征的构造，这里主要构造了时间相关的数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> [train,test]:</span><br><span class="line">        data[<span class="string">'month'</span>]=data[<span class="string">'game_date'</span>].apply(<span class="keyword">lambda</span> x: get_date(x,<span class="string">'month'</span>))</span><br><span class="line">        data[<span class="string">'year'</span>]=data[<span class="string">'game_date'</span>].apply(<span class="keyword">lambda</span> x: get_date(x,<span class="string">'year'</span>))</span><br><span class="line">        data[<span class="string">'day'</span>]=data[<span class="string">'game_date'</span>].apply(<span class="keyword">lambda</span> x: get_date(x,<span class="string">'day'</span>))</span><br><span class="line">        data[<span class="string">'range'</span>]=data[<span class="string">'shot_zone_range'</span>].map(&#123;<span class="string">'16-24 ft.'</span>:<span class="number">20</span>, <span class="string">'8-16 ft.'</span>:<span class="number">12</span>, <span class="string">'Less Than 8 ft.'</span>:<span class="number">4</span>, <span class="string">'24+ ft.'</span>:<span class="number">28</span>, <span class="string">'Back Court Shot'</span>:<span class="number">36</span>&#125;)</span><br><span class="line">        data[<span class="string">'season'</span>]=data[<span class="string">'season'</span>].apply(<span class="keyword">lambda</span> x: int(x.split(<span class="string">'-'</span>)[<span class="number">1</span>]))</span><br><span class="line">        data[<span class="string">'is_host'</span>]=data[<span class="string">'matchup'</span>].apply(<span class="keyword">lambda</span> x: <span class="number">1</span> <span class="keyword">if</span> <span class="string">'@'</span> <span class="keyword">in</span> x <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">        data[<span class="string">'shot_type'</span>]=data[<span class="string">'shot_type'</span>].apply(<span class="keyword">lambda</span> x: <span class="number">1</span> <span class="keyword">if</span> <span class="string">'2'</span> <span class="keyword">in</span> x <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">        data[<span class="string">'is_addTime'</span>]=data[<span class="string">'period'</span>].apply(<span class="keyword">lambda</span> x:<span class="number">1</span> <span class="keyword">if</span> x&gt;<span class="number">4</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>上述代码主要对时间数据进行了解析，然后提取了赛季数据，主客场，是否是2分投球，是否是加时赛等等。</p>
<p>另外，对多个类别的数据进行哑变量处理。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dummy_variables=[<span class="string">'action_type'</span>,<span class="string">'combined_shot_type'</span>,<span class="string">'shot_zone_area'</span>,<span class="string">'shot_zone_basic'</span>,<span class="string">'opponent'</span>]</span><br><span class="line">    <span class="keyword">for</span> var <span class="keyword">in</span> dummy_variables:</span><br><span class="line">        encoded = pd.get_dummies(pd.concat([train,test], axis=<span class="number">0</span>)[var],prefix=var)</span><br><span class="line">        train_rows = train.shape[<span class="number">0</span>]</span><br><span class="line">        train_encoded = encoded.iloc[:train_rows, :]</span><br><span class="line">        test_encoded = encoded.iloc[train_rows:, :]</span><br><span class="line">        features+=encoded.columns.tolist()</span><br><span class="line">        train = pd.concat([train, train_encoded], axis=<span class="number">1</span>)</span><br><span class="line">        test = pd.concat([test,test_encoded],axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>也有一种方法是对这些类别的数据经行一个有序的编号，比如从0~n，但是这样的编号会给后面的分类过程引入多余的信息，也就是给他们一个顺序的信息，而大多数情况下，这些类别数据是没有顺序关系的。我之前使用的是编号方法，结果是<code>0.607</code>，而使用哑变量的结果大大提高，结果到达了<code>0.60061</code>。看来对于这种类别型的数据，使用哑变量还是有效果的。</p>
<p>然后加了一些原始的特征，如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">features+=[<span class="string">'loc_x'</span>,<span class="string">'loc_y'</span>,<span class="string">'period'</span>,<span class="string">'minutes_remaining'</span>,<span class="string">'seconds_remaining'</span>,<span class="string">'shot_distance'</span>,<span class="string">'month'</span>,<span class="string">'year'</span>,<span class="string">'day'</span>,<span class="string">'season'</span>,<span class="string">'range'</span>,<span class="string">'is_host'</span>,<span class="string">'shot_type'</span>,<span class="string">'is_addTime'</span>]</span><br></pre></td></tr></table></figure>
<p>接下来是数据的标准化或者归一化，我使用<code>sklearn</code>中的<code>sklearn.preprocessing.StandardScaler</code>和<code>sklearn.preprocessing.MinMaxScaler</code>两个不同的函数，发现这连个函数对结果的影响不大，最终选择了归一化到0~1之间。</p>
<h2 id="使用模型"><a href="#使用模型" class="headerlink" title="使用模型"></a>使用模型</h2><p>这是一道明显的二分类问题，一般使用分类算法来进行计算，我选择使用的算法有<code>xgboost</code>，<code>neural networks</code>等等</p>
<h3 id="xgboost"><a href="#xgboost" class="headerlink" title="xgboost"></a>xgboost</h3><p>现在我感觉基本上<code>xgboost</code>都是数据竞赛的首选分类算法。这是<a href="https://xgboost.readthedocs.io/en/latest/" target="_blank" rel="noopener">文档</a>。可以使用<code>xgb.cv</code>来进行交叉验证和调参，也可以添加<code>watchlist</code>来进行调参。调参的方法可以人工调，也可以通过使用<strong>网格搜索</strong>或者<strong>随机搜索</strong>来进行参数搜索。</p>
<p>我是用了以下的参数进行了计算，如果需要复现，可能需要根据具体情况进行调参。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">params = &#123;<span class="string">'max_depth'</span>:<span class="number">8</span>, <span class="string">'eta'</span>:<span class="number">0.02</span>,<span class="string">'silent'</span>:<span class="number">1</span>,</span><br><span class="line">          <span class="string">'objective'</span>:<span class="string">'binary:logistic'</span>, <span class="string">'eval_metric'</span>: <span class="string">'logloss'</span>,</span><br><span class="line">          <span class="string">'min_child_weight'</span>:<span class="number">3</span>, <span class="string">'subsample'</span>:<span class="number">0.5</span>,<span class="string">'colsample_bytree'</span>:<span class="number">0.5</span>, <span class="string">'nthread'</span>:<span class="number">4</span>&#125;</span><br><span class="line">num_rounds = <span class="number">290</span></span><br></pre></td></tr></table></figure>
<p>然后开始训练模型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">watchlist = [(xgbdev,<span class="string">'eval'</span>), (xgbtrain,<span class="string">'train'</span>)]</span><br><span class="line">evals_result = &#123;&#125;</span><br><span class="line">classifier = xgb.train(params, xgbtrain, num_rounds, watchlist)</span><br></pre></td></tr></table></figure>
<p>最后进行测试和输出<br>当然，我也是用了其他的模型方法</p>
<h3 id="neural-networks"><a href="#neural-networks" class="headerlink" title="neural networks"></a>neural networks</h3><p>我主要使用了<a href="http://keras.io/" target="_blank" rel="noopener">Keras</a>来实现神经网络，<code>Keras</code>是一个python的神经网络库，它的backend可以选择为<code>Theano</code>或<code>TensorFlow</code>，最近出的<code>functional api</code>感觉非常不错。以下是我的keras的代码，我尝试着使用了1~2层隐藏层，隐藏层的节点数选择了<code>50</code>，<code>100</code>等参数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">features_cnt = len(features)</span><br><span class="line">inputs = Input(shape=(features_cnt,))</span><br><span class="line">dense1 = Dense(<span class="number">100</span>, activation=<span class="string">'relu'</span>)(inputs)</span><br><span class="line">dropout1 = Dropout(<span class="number">0.5</span>)(dense1)</span><br><span class="line">outputs = Dense(<span class="number">1</span>, activation=<span class="string">'sigmoid'</span>)(dropout1)</span><br><span class="line">model = Model(input=inputs, output=outputs)</span><br><span class="line">model.compile(loss=<span class="string">'binary_crossentropy'</span>,</span><br><span class="line">              optimizer=<span class="string">'sgd'</span>, metrics=[<span class="string">'accuracy'</span>])</span><br><span class="line">print(<span class="string">"Start Training"</span>, time.ctime())</span><br><span class="line">model.fit(train[features].values, train[target].values,</span><br><span class="line">          batch_size=<span class="number">12</span>, nb_epoch=<span class="number">100</span>, validation_split=<span class="number">0.25</span>)</span><br></pre></td></tr></table></figure>
<h2 id="组合模型"><a href="#组合模型" class="headerlink" title="组合模型"></a>组合模型</h2><p>在这里，我只是用了<code>bagging</code>的方法，我用之前的模型获得了5个结果。结果列表如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">files=[<span class="string">'xgboost-feature-submit_best.csv'</span>,<span class="string">'xgboost-dummy-feature-best.csv'</span>,<span class="string">'nn-feature-submit.csv'</span>,<span class="string">'nn-tanh-feature-submit.csv'</span>,<span class="string">'xgboost-linear-feature-submit.csv'</span>]</span><br></pre></td></tr></table></figure>
<p>这五个模型分别是xgboost调参后最好的模型（没有将类别变量变为哑变量），变为哑变量后的最好结果，神经网络的结果（使用relu激活函数），使用tanh激活函数的结果，使用线性方法的xgboost结果</p>
<p>其权重以及<code>Public Leaderboard</code>结果：</p>
<ul>
<li><code>weight=[0.15,0.6,0.1,0.15,0.1]</code> 结果 <code>0.62815</code></li>
<li><code>weight=[0.05,0.7,0.1,0.05,0.1]</code> 结果 <code>0.60009</code></li>
<li><code>weight=[0.05,0.75,0.1,0.05,0.05]</code> 结果 <code>0.59987</code></li>
<li><code>weight=[0.05,0.8,0.05,0.05,0.05]</code> 结果 <code>0.60008</code></li>
<li><code>weight=[0.04,0.73,0.15,0.04,0.04]</code> 结果 <code>0.59970</code></li>
<li><code>weight=[0.04,0.7,0.18,0.04,0.04]</code> 结果 <code>0.59962</code></li>
<li><code>weight=[0.04,0.6,0.28,0.04,0.04]</code> 结果 <code>0.59952</code></li>
<li><code>weight=[0.05,0.55,0.30,0.05,0]</code> 结果 <code>0.59959</code></li>
<li><code>weight=[0.01,0.55,0.36,0.04,0.04]</code> 结果 <code>0.59953</code></li>
<li><code>weight=[0.01,0.55,0.38,0.03,0.03]</code> 结果 <code>0.59951</code></li>
</ul>
<p>结论，<code>bagging</code>的方法还是有一定作用的，毕竟单个模型还没有低于<code>0.6</code>的</p>
<h2 id="解题心得"><a href="#解题心得" class="headerlink" title="解题心得"></a>解题心得</h2><h3 id="学到的知识"><a href="#学到的知识" class="headerlink" title="学到的知识"></a>学到的知识</h3><ul>
<li>对于<code>pandas</code>的操作更熟练了</li>
<li>对于<code>哑变量</code>有了更深刻的理解</li>
<li>对于<code>bagging</code>的方法有了更深入的了解，<code>bagging</code>的确可以提高准确率</li>
</ul>
<h3 id="不足"><a href="#不足" class="headerlink" title="不足"></a>不足</h3><ul>
<li>前期对于数据的分析还不够，感觉就是搬个模型在套，如果能够分析好数据，解题的过程会更加地有方向</li>
<li>没有考虑其他<code>集成学习</code>的算法</li>
<li>没有考虑其他的算法，如<code>KNN</code>，<code>SVM</code>等</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Victor Zhang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://cupdish.com/2016/06/15/kobe/">http://cupdish.com/2016/06/15/kobe/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://cupdish.com" target="_blank">Cupdish.com</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/kaggle/">kaggle</a><a class="post-meta__tags" href="/tags/Kobe/">Kobe</a><a class="post-meta__tags" href="/tags/结题报告/">结题报告</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/03/24/post/"><i class="fa fa-chevron-left">  </i><span>要好好开始写论文了</span></a></div><div class="next-post pull-right"><a href="/2016/05/29/KDDCup2016-总结/"><span>KDDCup2016 总结</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="disqus_thread"></div><script>var disqus_shortname = ''
var disqus_config = function () {
  this.page.url = 'http://cupdish.com/2016/06/15/kobe/';
  this.page.identifier = '2016/06/15/kobe/';
  this.page.title = 'Kobe 投篮预测比赛解题报告';
}
var d = document, s = d.createElement('script');
s.src = "https://" + disqus_shortname +".disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2018 By Victor Zhang</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.1"></script><script src="/js/fancybox.js?version=1.5.1"></script><script src="/js/sidebar.js?version=1.5.1"></script><script src="/js/copy.js?version=1.5.1"></script><script src="/js/fireworks.js?version=1.5.1"></script><script src="/js/transition.js?version=1.5.1"></script><script src="/js/scroll.js?version=1.5.1"></script><script src="/js/head.js?version=1.5.1"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>